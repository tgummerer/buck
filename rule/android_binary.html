<!doctype html><html xmlns="http://www.w3.org/1999/xhtml"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns#"><title>Buck: android_binary()</title><link type="image/png" rel="shortcut icon" href="/buck/static/favicon.png" /><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" /><meta http-equiv="content-type" content="text/html;charset=utf-8"><link type="text/css" rel="stylesheet" href="/buck/google-code-prettify/prettify.css" ><link type="text/css" rel="stylesheet" href="/buck/static/buck.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-40185670-1', 'github.io'); ga('send', 'pageview');</script><meta property="og:locale" content="en_US"><meta property="og:title" content="android_binary()"><meta property="og:site_name" content="Buck: a build tool"><meta property="og:image" content="http://facebook.github.io/buck/static/og.png"><meta property="og:type" content="article"><meta property="og:description" content="A rule that generates an Android APK."><meta property="fb:admins" content="584556688222168"></head><body><div id="fb-root"></div><script>(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=584556688222168"; fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));</script><header class='topbar'><nav class='width'><a href='http://facebook.github.io/buck/'><h1>Buck</h1></a><ul class='menu'><li><a href='/buck/setup/quick_start.html'>Get Started</a><li><a href='https://groups.google.com/forum/#!forum/buck-build'>Group</a><li><a href='/buck/javadoc/'>API</a><li><a href='https://github.com/facebook/buck'>GitHub</a></ul></nav></header><section class='content'><div class='width'><article><h1>android_binary()</h1><div class="overview">An <code>android_binary()</code> rule is used to generate an Android APK.<h2>Arguments</h2><ul class="arglist"><li class="arg"><code>name</code> (required) The name of the rule, as well as the name of the APK generated by this rule.<li class="arg"><code>manifest</code> (required) Relative path to the Android manifest for the APK. The common case is that the manifest will be in the same directory as the <code>android_binary()</code>, in which case this will simply be <code>'AndroidManifest.xml'</code>.<li class="arg"><code>keystore</code> (required) A build target that identifies a <a href="/buck/rule/keystore.html"><code>keystore</code></a> to use to sign the APK. See <a href="/buck/setup/quick_start.html">Quick Start</a> for more details.<li class="arg"><code>package_type</code> (defaults to <code>&#39;debug&#39;</code>) Determines whether ProGuard will be used when packaging the APK. Acceptable values for <code>package_type</code> are <code>'debug'</code> and<code>'release'</code>. The default value is <code>'debug'</code>, which indicates that ProGuard should not be used.<p><strong>Note:</strong> This argument will be renamed to reflect that it determines the use of ProGuard.<li class="arg"><code>proguard_config</code> (defaults to <code>None</code>) Relative path to a ProGuard configuration file that will be passed via the <code>-include</code> flag when <code>package_type</code> is <code>'release'</code>.<li class="arg"><code>android_sdk_proguard_config</code> (defaults to <code>&#39;default&#39;</code>) The type of proguard configuration to use from the Android SDK. Options are <code>'default'</code> to use the default config,<code>'optimized'</code> to use the config with optimizations enabled, or <code>'none'</code> to not use any standard configuration (you will need to supply your own version, otherwise your app will probably not work).<li class="arg"><code>no_dx</code> (defaults to <code>[]</code>) List of build targets that may have been included during compilation of  the transitive <code>android_library()</code> and <code>java_library()</code> dependencies, but should not be included in the <code>classes.dex</code> for generated for the APK.<li class="arg"><code>build_config_values</code> (defaults to <code>[]</code>) See the documentation on the <tt>values</tt> argument for <a href="/buck/rule/android_build_config.html"><code>android_build_config</code></a>.<li class="arg"><code>build_config_values_file</code> (defaults to <code>None</code>) See the documentation on the <tt>values_file</tt> argument for <a href="/buck/rule/android_build_config.html"><code>android_build_config</code></a>.<li class="arg"><code>skip_crunch_pngs</code> (defaults to <code>False</code>) If <code>True</code>, PNGs in the APK are not crushed by aapt. This is equivalent to specifying<pre class="prettyprint lang-js">
  android {
      aaptOptions.useAaptPngCruncher = false
  }
  </pre>in gradle, or<pre class="prettyprint lang-xml">
  &lt;target name="-crunch">
      &lt;echo message="Skipping PNG optimization"/>
  &lt;/target>
  </pre>in ant. This can be useful if the PNGs have been optimised beforehand, as aapt would attempt to crush the optimised PNGs and end up increasing their size instead of decreasing it.<li class="arg"><code>deps</code> (defaults to <code>[]</code>) List of build targets whose corresponding compiled Java code, Android resources, and native libraries will be included in the APK. From the transitive closure of these dependencies, the outputs of rules of the following type will be included in the APK:<ul><li><code>android_library()</code><li><code>android_resource()</code><li><code>java_library()</code><li><code>java_binary()</code><li><code>prebuilt_jar()</code><li><code>ndk_library()</code><li><code>prebuilt_native_library()</code></ul><li class="arg"><code>visibility</code> (defaults to <code>[]</code>) List of <a href="/buck/concept/build_target_pattern.html">build target patterns</a> that identify the build rules that can include this rule in its <code>deps</code>.</ul><h2>Examples</h2>Here is an example of an <code>android_binary()</code> rule that includes Android resources from one dependency and compiled Java code from another dependency:<pre class="prettyprint lang-py">
android_resource(
  name = 'res',
  res = 'res',
  assets = 'assets',
)

android_library(
  name = 'src',
  srcs = glob(['src/**/*.java']),
  deps = [
    ':res',
  ],
)

# Building this rule will produce a file named messenger.apk.
android_binary(
  name = 'messenger',
  manifest = 'AndroidManifest.xml',
  keystore = '//keystores:prod',
  package_type = 'release',
  proguard_config = 'proguard.cfg',
  deps = [
    ':res',
    ':src',
  ],
)
</pre></div></article><nav><h3>Getting Started</h3><ul><li><a href="/buck/">Overview</a><li><a href="/buck/setup/quick_start.html">Quick Start</a><li><a href="/buck/setup/install.html">Downloading and Installing Buck</a><li><a href="/buck/article/exopackage.html">Exopackage</a></ul><h3>About</h3><ul><li><a href="/buck/concept/what_makes_buck_so_fast.html">What Makes Buck so Fast?</a><li><a href="/buck/concept/troubleshooting.html">Troubleshooting</a><li><a href="/buck/about/performance_tuning.html">Performance Tuning</a><li><a href="/buck/concept/faq.html">FAQ</a><li><a href="/buck/presentations/">Learn More (Buck Presentations)</a></ul><h3>Concepts</h3><ul><li><a href="/buck/concept/build_rule.html">Build Rule</a><li><a href="/buck/concept/build_target.html">Build Target</a><li><a href="/buck/concept/build_file.html">Build File</a><li><a href="/buck/concept/buckversion.html">.buckversion</a><li><a href="/buck/concept/nobuckcheck.html">.nobuckcheck</a><li><a href="/buck/concept/buckconfig.html">.buckconfig</a><li><a href="/buck/concept/build_target_pattern.html">Build Target Pattern</a><li><a href="/buck/concept/visibility.html">Visibility</a><li><a href="/buck/concept/http_cache_api.html">HTTP Cache API</a></ul><h3>Build Rules</h3><ul><li><a href="/buck/rule/android_aar.html">android_aar()</a><li><a href="/buck/rule/android_binary.html">android_binary()</a><li><a href="/buck/rule/android_build_config.html">android_build_config()</a><li><a href="/buck/rule/android_library.html">android_library()</a><li><a href="/buck/rule/android_prebuilt_aar.html">android_prebuilt_aar()</a><li><a href="/buck/rule/android_resource.html">android_resource()</a><li><a href="/buck/rule/apk_genrule.html">apk_genrule()</a><li><a href="/buck/rule/cxx_binary.html">cxx_binary()</a><li><a href="/buck/rule/cxx_library.html">cxx_library()</a><li><a href="/buck/rule/cxx_test.html">cxx_test()</a><li><a href="/buck/rule/d_binary.html">d_binary()</a><li><a href="/buck/rule/d_library.html">d_library()</a><li><a href="/buck/rule/d_test.html">d_test()</a><li><a href="/buck/rule/gen_aidl.html">gen_aidl()</a><li><a href="/buck/rule/genrule.html">genrule()</a><li><a href="/buck/rule/java_binary.html">java_binary()</a><li><a href="/buck/rule/java_library.html">java_library()</a><li><a href="/buck/rule/java_test.html">java_test()</a><li><a href="/buck/rule/keystore.html">keystore()</a><li><a href="/buck/rule/ndk_library.html">ndk_library()</a><li><a href="/buck/rule/prebuilt_jar.html">prebuilt_jar()</a><li><a href="/buck/rule/prebuilt_native_library.html">prebuilt_native_library()</a><li><a href="/buck/rule/project_config.html">project_config()</a><li><a href="/buck/rule/python_binary.html">python_binary()</a><li><a href="/buck/rule/python_library.html">python_library()</a><li><a href="/buck/rule/python_test.html">python_test()</a></ul><h3>Functions</h3><ul><li><a href="/buck/function/glob.html">glob()</a><li><a href="/buck/function/include_defs.html">include_defs()</a><li><a href="/buck/function/string_parameter_macros.html">String Parameter Macros</a></ul><h3>Commands</h3><ul><li><a href="/buck/command/audit.html">buck audit</a><li><a href="/buck/command/build.html">buck build</a><li><a href="/buck/command/clean.html">buck clean</a><li><a href="/buck/command/install.html">buck install</a><li><a href="/buck/command/project.html">buck project</a><li><a href="/buck/command/quickstart.html">buck quickstart</a><li><a href="/buck/command/server.html">buck server</a><li><a href="/buck/command/targets.html">buck targets</a><li><a href="/buck/command/test.html">buck test</a><li><a href="/buck/command/uninstall.html">buck uninstall</a><li><a href="/buck/command/buckd.html">buckd</a></ul><h3>Extending Buck</h3><ul><li><a href="/buck/extending/macros.html">Custom Macros</a><li><a href="/buck/extending/rules.html">Custom Rules</a></ul><h3>Contributing to Buck</h3><ul><li><a href="https://groups.google.com/group/buck-build">Discussion Group</a><li><a href="https://github.com/facebook/buck/issues/new">Report a Bug</a><li><a href="/buck/contributing/tour.html">Tour of the Codebase</a><li><a href="/buck/contributing/development.html">Development Workflow</a><li><a href="/buck/contributing/codestyle.html">Code Style</a><li><a href="/buck/contributing/logging.html">Logging</a><li><a href="/buck/contributing/immutables.html">Immutable Value Types</a><li><a href="/buck/javadoc">API</a><li><a href="https://github.com/facebook/buck">Browse the Source Code</a></ul></ul></nav></div></section><footer><div class='width'>&copy; Copyright Facebook, 2013 -</div></footer><script src="/buck/google-code-prettify/prettify.js"></script><script>prettyPrint()</script></body></html>